# 20 面向数据编程与任务系统

## Basics of Parallel Programming

抢占式 和 非抢占式

Blocking Algorithm - Locking primitives

Lock: 
- Only one thread can acquire the lock at a time
- Make a critical section for shared resources access

容易产生死锁问题。lock尽量不要使用。


Lock-free programming:

- Atomic Loads and Stores
- Atomic Read-Modify-Write (RMW)

Lock-free容易造成CPU空档，浪费性能。


## Fixed Multithread

为不同任务固定一个单独线程
- Render, simulation, logic, network, etc.
- Easy to implement

会出现木桶短板效应。

Thread Fork-Join 为fixed线程分支子任务

Task Graph

## Job System

## Coroutine

Allows for multitasking by creating jobs inside of coroutines

Lightweight execution context


Fiber-based job system

## Problems of OOP

- Hard to know which parent class has the method implementation
- Messy based class
- Performance: Memory scattering, jungle of virtual functions
- Testability

## DoP

Processor-Memory Performance Gap

LRU - When cache is full, discards the least recently used cache-line first

Data is all we have - code and data看成整体

减少对执行顺序的依赖；branch prediction是对代码的优化

避免复杂if-else

